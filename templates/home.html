{% extends "base.html" %}
{% load static %}

{% block content %}

  {# HERO FEATURED POST #}
  {% for post in featured_posts %}
    {% if forloop.first %}
      <section
        class="jumbotron p-3 p-md-5 text-white rounded bg-dark mb-4 position-relative overflow-hidden"
        style="
          background-image: url({{ post.featured_image.url }});
          background-size: cover;
          background-position: center;
          background-blend-mode: overlay;
        "
      >
        <div class="col-md-8 px-0">
          <span class="badge badge-warning text-uppercase mb-2">Featured</span>
          <h1 class="display-4 font-italic mb-3">
            {{ post.title }}
          </h1>
          <p class="lead my-3">
            {{ post.short_description|truncatewords:20 }}
          </p>
          <p class="lead mb-0">
            <a href="{% url 'blogs' post.slug %}" class="text-white font-weight-bold">
              Continue reading…
            </a>
          </p>
        </div>
      </section>
    {% endif %}
  {% endfor %}

  {# FEATURED POSTS LIST #}
  <section class="mb-5">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h3 class="text-uppercase text-warning mb-0" style="letter-spacing: 2px;">
        Featured Posts
      </h3>
      <span class="text-muted small d-none d-md-inline">
        Handpicked highlights
      </span>
    </div>

    <div class="row mb-2">
      {% for post in featured_posts %}
        {% if not forloop.first %}
          <div class="col-md-6 mb-3">
            <div class="card border-0 h-100 shadow-sm">
              <div class="card-body d-flex flex-column">
                <h3 class="h5 mb-2">
                  <a href="{% url 'blogs' post.slug %}" class="text-dark font-weight-bold">
                    {{ post.title }}
                  </a>
                </h3>
                <small class="mb-2 text-muted">
                  {{ post.created_at|timesince }} ago &nbsp;|&nbsp; {{ post.author }}
                </small>
                <p class="card-text mb-3">
                  {{ post.short_description|truncatewords:20 }}
                </p>
                <a href="{% url 'blogs' post.slug %}" class="mt-auto small text-warning font-weight-bold">
                  Read more →
                </a>
              </div>
            </div>
          </div>
        {% endif %}
      {% empty %}
        <div class="col-12">
          <p class="text-muted">No featured posts available.</p>
        </div>
      {% endfor %}
    </div>
  </section>

  {# RECENT ARTICLES + SIDEBAR #}
  <section class="mb-5">
  <h3 class="text-uppercase text-warning mb-4" style="letter-spacing: 2px;">
    Recent Articles
  </h3>

  <main role="main" class="container p-0">
    <div class="row">

      <!-- MAIN BLOG LIST -->
      <div class="col-md-8 blog-main mb-4">

        {% for post in page_obj %}
          <article class="card border-0 mb-4 shadow-sm">
            <div class="card-body">
              <h3 class="h4">
                <a href="{% url 'blogs' post.slug %}" class="text-dark font-weight-bold">
                  {{ post.title }}
                </a>
              </h3>

              <small class="mb-2 d-block text-muted">
                {{ post.created_at|timesince }} ago | {{ post.author }}
              </small>

              <p class="card-text mb-3">
                {{ post.short_description|truncatewords:20 }}
              </p>

              <a href="{% url 'blogs' post.slug %}" class="small text-warning font-weight-bold">
                Continue reading →
              </a>
            </div>
          </article>
        {% empty %}
          <p class="text-muted">No posts found.</p>
        {% endfor %}

      </div>


          {# FOLLOW US #}
          {% if social %}
            <div class="p-3 bg-white rounded shadow-sm">
              <h4 class="font-italic mb-3">Follow Us</h4>
              <ol class="list-unstyled mb-0">
                {% for i in social %}
                  <li class="mb-2">
                    <a href="{{ i.link }}" class="text-muted">
                      {{ i.plateform }}
                    </a>
                  </li>
                {% endfor %}
              </ol>
            </div>
          {% endif %}

        </aside>

      </div>
    </main>
  </section>


  <nav aria-label="Page navigation" class="mt-4">
  <ul class="pagination justify-content-center">

    {% if page_obj.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?page=1">« First</a>
      </li>
      <li class="page-item">
        <a class="page-link" href="?page={{ page_obj.previous_page_number }}">‹ Prev</a>
      </li>
    {% else %}
      <li class="page-item disabled">
        <span class="page-link">« First</span>
      </li>
      <li class="page-item disabled">
        <span class="page-link">‹ Prev</span>
      </li>
    {% endif %}

    <li class="page-item active">
      <span class="page-link">
        {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}
      </span>
    </li>

    {% if page_obj.has_next %}
      <li class="page-item">
        <a class="page-link" href="?page={{ page_obj.next_page_number }}">Next ›</a>
      </li>
      <li class="page-item">
        <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}">Last »</a>
      </li>
    {% else %}
      <li class="page-item disabled">
        <span class="page-link">Next ›</span>
      </li>
      <li class="page-item disabled">
        <span class="page-link">Last »</span>
      </li>
    {% endif %}

  </ul>
</nav>


{% endblock %}

